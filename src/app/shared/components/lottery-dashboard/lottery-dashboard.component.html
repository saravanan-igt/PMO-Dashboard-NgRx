<div class="container-fluid" *ngIf="DataLists">
  <div class="row">
    <div class="col-6">
      <h2 class="page-title">{{ pageTitle }}</h2>
    </div>
    <div class="col-6">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="#">Home</a></li>
          <li class="breadcrumb-item active" aria-current="page">
            {{ pageTitle }}
          </li>
        </ol>
      </nav>
    </div>
  </div>
  <div class="row info-container">
    <button
      type="button"
      triggers="mouseenter:mouseleave"
      mat-icon-button
      class="info-btn text-white"
      [ngbPopover]="projectContent"
    >
      <mat-icon fontSet="material-icons-outlined">info</mat-icon>
    </button>
    <ng-template #projectContent>
      <p>
        These charts reflect the number of projects in the combined Lottery
        Portfolio and individual Lottery portfolios by business type. Active (in
        delivery), Planned (0,1,2 probability, forecasted opportunities), and
        Closed (projects that have gone live in 2020).
      </p>
      <p>
        A combination of data fields per business type in RI Clarity are being
        used to indicate whether a project is active, completed, or planned.
      </p>
    </ng-template>
    <div class="col-xl-3 col-md-6 mb-4">
      <app-project-category
        *ngIf="lotteryProjectsData"
        chartTitle="Total Projects"
        [data]="lotteryProjectsData"
      ></app-project-category>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
      <app-project-category
        *ngIf="lotterySVProjectsData"
        chartTitle="Service Delivery Projects"
        [data]="lotterySVProjectsData"
      ></app-project-category>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
      <app-project-category
        *ngIf="lotterySDProjectsData"
        chartTitle="System Delivery Projects"
        [data]="lotterySDProjectsData"
      ></app-project-category>
    </div>
    <div class="col-xl-3 col-md-6 mb-4">
      <app-project-category
        *ngIf="lotteryPlannedProjectsData"
        chartTitle="R&D Projects"
        [data]="lotteryPlannedProjectsData"
      ></app-project-category>
    </div>
  </div>

  <div class="row info-container">
    <button
      type="button"
      triggers="mouseenter:mouseleave"
      mat-icon-button
      class="info-btn"
      [ngbPopover]="budgetContent"
    >
      <mat-icon fontSet="material-icons-outlined">info</mat-icon>
    </button>
    <ng-template #budgetContent>
      <p>
        These charts reflect combined Lottery portfolio and individual Lottery
        portfolio budget figures from different fields in RI Clarity depending
        upon the business type. The numbers reflected are as of the latest
        forecast revision.
      </p>
      <strong>System and Services Delivery</strong>
      <ul>
        <li>
          Active project budgets = The current amount in the Cost Plan Version 0
          field in RI Clarity.
        </li>
        <li>
          Closed project budgets = The current amount in the Actuals To Date
          field in Clarity.
        </li>
        <li>
          Planned project budgets = The current amount in the Current Forecast
          field.
        </li>
      </ul>
      <strong>R&D</strong>
      <ul>
        <li>
          Active project budgets = The current amount in the As Negotiated
          Budget field.
        </li>
        <li>
          Closed project budgets = The current amount in the Actuals to Date
          field.
        </li>
        <li>
          Planned project budgets = The current amount in the Current Forecast
          field.
        </li>
      </ul>
    </ng-template>
    <div class="col-xl-4 col-md-5 mb-4">
      <app-budget-chart
        chartTitle="Lottery Budget"
        [data]="totalBudgetData"
        height="250"
        [radius]="'60%'"
      ></app-budget-chart>
    </div>
    <div class="col-xl-8 col-md-7 mb-4">
      <app-budget-bar-chart
        chartTitle="Lottery Budget Portfolio"
        [seriesData]="budgetSeriesData"
        yAxisName=""
        [xAxisData]="xAxisData"
      ></app-budget-bar-chart>
    </div>
  </div>

  <div class="row info-container">
    <button
      type="button"
      triggers="mouseenter:mouseleave"
      mat-icon-button
      class="info-btn"
      [ngbPopover]="forecastContent"
    >
      <mat-icon fontSet="material-icons-outlined">info</mat-icon>
    </button>
    <ng-template #forecastContent>
      <p>
        This section represents the budget performance by Active and Closed
        projects in the Lottery portfolio, further broken down business type.
      </p>
      <p>
        Cost Planning indicates the approved budget or cost plan per project.
        Current Forecast represents the Actuals + ETC.
      </p>
    </ng-template>
    <div class="col-12 mb-4">
      <app-forecast-chart
        *ngIf="forecastSeriesData"
        [seriesData]="forecastSeriesData"
        yAxisName=""
        [xAxisData]="forecastLegend"
        [gridLeft]="'10%'"
        chartTitle="Lottery"
      ></app-forecast-chart>
    </div>
  </div>

  <div class="row info-container">
    <button
      type="button"
      triggers="mouseenter:mouseleave"
      mat-icon-button
      class="info-btn"
      [ngbPopover]="ragContent"
    >
      <mat-icon fontSet="material-icons-outlined">info</mat-icon>
    </button>
    <ng-template #ragContent>
      <p>
        The RAG status displayed for the Active projects in the combined Lottery
        portfolio as well as by individual business types represents the Overall
        Project Status indicator from the most current submitted RI Clarity
        Project Status Reports.
      </p>
      <p>
        Based upon Scope/Schedule/Budget/Quality/CSAT activity, the calculation
        criteria for the Overall Status indicator per project is:
      </p>
      <ul>
        <li>
          If either Schedule, Scope, or Budget = High or Med, then Overall
          Status reflects same
        </li>
        <li>
          If both quality and CSAT = High or Med, then Overall Status reflects
          same
        </li>
        <li>
          Budget Status is a calculated field based upon current project
          variance:
          <ul>
            <li>0% - 1.9% variance = Green</li>
            <li>2% - 4.9% variance = Yellow</li>
            <li>5% or greater variance = Red</li>
          </ul>
        </li>
      </ul>
      <strong>Exception</strong>
      <p>
        If no status indicator is available for a project then it defaults to
        Low risk, (green).
      </p>
    </ng-template>
    <div class="col-md-4 mb-4">
      <!-- (onChartEvent)="chartEvent($event)" -->
      <app-budget-chart
        chartTitle="Lottery Projects RAG Status"
        [data]="totalRiskData"
        [labelFormatter]="'{c}'"
        [totalText]="false"
        [color]="[
          'rgba(255,91,86,0.85)',
          'rgba(245,156,26,0.85)',
          'rgba(0,191,165,0.85)'
        ]"
        height="250"
      ></app-budget-chart>
    </div>
    <div class="col-md-8 mb-4">
      <app-budget-bar-chart
        chartTitle="Lottery Projects Risk Profile"
        [seriesData]="riskProfileData"
        [labelFormatter]="'{c}'"
        [yAxisFormat]="'{value}'"
        [color]="[
          'rgba(255,91,86,0.85)',
          'rgba(245,156,26,0.85)',
          'rgba(0,191,165,0.85)'
        ]"
        yAxisName="No. of Projects"
        [xAxisData]="xAxisData"
      ></app-budget-bar-chart>
    </div>
  </div>

  <div class="row info-container">
    <button
      type="button"
      triggers="mouseenter:mouseleave"
      mat-icon-button
      class="info-btn"
      [ngbPopover]="goLiveContent"
    >
      <mat-icon fontSet="material-icons-outlined">info</mat-icon>
    </button>
    <ng-template #goLiveContent>
      <p>
        The calendar graphic displays only Active (in delivery) Lottery
        projects.
      </p>
      <p>
        The triangles are positioned under the month of go live with the color
        representing the risk level of project as indicated in the RAG status
        section. Hovering over a triangle reveals the exact go live date.
      </p>
      <p>
        * Select the values from <strong>RAG Status</strong> and
        <strong>Business</strong> dropdown buttons to isolate those projects in
        the calendar view. Select <strong>All</strong> in both the dropdowns to
        display all statuses.
      </p>
    </ng-template>
    <div class="col-12" *ngIf="calendarData">
      <app-go-live-calendar
        [scheduleData]="calendarData"
        [calendarTitle]="'Lottery Projects RAG Status'"
        [ragFilter]="true"
        [businessFilter]="'BusinessTypeCode|BUSINESS_TYPE'"
      ></app-go-live-calendar>
    </div>
  </div>
</div>
